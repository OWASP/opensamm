<!doctype html><html><head><meta charset=utf-8><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta name=viewport content="width=device-width,initial-scale=1"><title>Secret Management</title><meta name=author content><meta name=keywords content="Business function,Practice,Implementation,Secure Deployment"><meta name=description content="Implementation / Secure Deployment"><meta name=generator content="Hugo 0.59.1"><link href="//fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,500,700,800" rel=stylesheet type=text/css><link rel=stylesheet href=//use.fontawesome.com/releases/v5.10.2/css/all.css><link rel=stylesheet href=//use.fontawesome.com/releases/v5.10.2/css/v4-shims.css><link rel=stylesheet href=//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css integrity=sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u crossorigin=anonymous><link href=/css/animate.css rel=stylesheet><link href=/css/style.samm.css rel=stylesheet id=theme-stylesheet><link href=/css/custom.css rel=stylesheet><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel="shortcut icon" href=/img/favicon.ico type=image/x-icon><link rel=apple-touch-icon href=/img/apple-touch-icon.png><link href=/css/owl.carousel.css rel=stylesheet><link href=/css/owl.theme.css rel=stylesheet><link rel=alternate href=https://owaspsamm.org/index.xml type=application/rss+xml title="OWASP SAMM"><meta property="og:title" content="Secret Management"><meta property="og:type" content="website"><meta property="og:url" content="./model/implementation/secure-deployment/stream-b//"><meta property="og:image" content="/img/logo.png"><link rel=stylesheet type=text/css href=https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css></head><body><div id=all><header><div class=navbar-affixed-top data-spy=affix data-offset-top=200><div class="navbar navbar-default yamm" role=navigation id=navbar><div class=container><div class=navbar-header><a class="navbar-brand home" href=https://owaspsamm.org/><img src=https://owaspsamm.org//img/logo.png alt="Secret Management logo" class="hidden-xs hidden-sm">
<img src=https://owaspsamm.org//img/logo-small.png alt="Secret Management logo" class="visible-xs visible-sm">
<span class=sr-only>Secret Management - ir a inicio</span></a><div class=navbar-buttons><button type=button class="navbar-toggle btn-template-main" data-toggle=collapse data-target=#navigation>
<span class=sr-only>Cambiar Navegaci√≥n</span>
<i class="fa fa-align-justify"></i></button></div></div><div class="navbar-collapse collapse" id=navigation><ul class="nav navbar-nav navbar-right"><li class=dropdown><a href=/about/>About SAMM</a></li><li class=dropdown><a href=/model/>The model</a></li><li class=dropdown><a href=# class=dropdown-toggle data-toggle=dropdown role=button aria-haspopup=true aria-expanded=false>Guidance <span class=caret></span></a><ul class=dropdown-menu><li><a href=/guidance/quick-start-guide/>Getting started</a></li><li><a href=/assessment/>Assessment</a></li><li><a href=/guidance/agile/>Agile</a></li><li><a href=/benchmarking/>Benchmarking</a></li></ul></li><li class=dropdown><a href=# class=dropdown-toggle data-toggle=dropdown role=button aria-haspopup=true aria-expanded=false>Community <span class=caret></span></a><ul class=dropdown-menu><li><a href=/blog/>Blog</a></li><li><a href=/events/>Events</a></li><li><a href=/sponsors/>Sponsors</a></li><li><a href=/faq/>FAQ</a></li><li><a href=/contributing/>Contributing</a></li></ul></li><li class=dropdown><a href=/user-day/>User Day</a></li><li class=dropdown><a href=/contact/>Contact</a></li></ul></div><div class="collapse clearfix" id=search><form class=navbar-form role=search><div class=input-group><input type=text class=form-control placeholder=Search>
<span class=input-group-btn><button type=submit class="btn btn-template-main"><i class="fa fa-search"></i></button></span></div></form></div></div></div></div></header><div id=heading-breadcrumbs><div class=container><div class=row><div class=col-md-12><h1>Secret Management</h1></div></div></div></div><div id=content><div class=container><div class=row><div class="col-md-12 samm-page-content"><h3><a href=../../>Model</a> | <a href=../../implementation>Implementation</a> | <a href=/model/implementation/secure-deployment>Secure Deployment</a> | Secret Management</h3><div class=tab><button class=tablinks onclick="openMaturityLevel(event,'1')" id=maturity1>Maturity level 1</button>
<button class=tablinks onclick="openMaturityLevel(event,'2')" id=maturity2>Maturity level 2</button>
<button class=tablinks onclick="openMaturityLevel(event,'3')" id=maturity3>Maturity level 3</button></div><div id=1 class=tabcontent><h2></h2><h3>Benefit</h3><p>Defined and limited access to your production secrets</p><h3>Activity</h3><p><p>Developers should not have access to secrets or credentials for production environments. Have a mechanism in place to adequately protect production secrets, for instance by (i) having specific persons adding them to relevant configuration files upon deployment (the separation of duty principle) or (ii) by encrypting the production secrets contained in the configuration files upfront.</p><p>Do not use production secrets in configuration files for development or testing environments, as such environments may have a significantly lower security posture. Similarly, do not keep secrets unprotected in configuration files stored in code repositories.</p><p>Store sensitive credentials and secrets for production systems with encryption-at-rest at all times. Consider using a purpose-built tool for this. Handle key management carefully so only personnel with responsibility for production deployments are able to access this data.</p></p><h3>Question</h3><p>Do you limit access to application secrets according to the least privilege principle?</p><h3>Quality criteria</h3><table class=table><tbody><tr><td>You store production secrets protected in a secured location</td></tr><tr><td>Developers do not have access to production secrets</td></tr><tr><td>Production secrets are not available in non-production environments</td></tr></tbody></table><h3>Answers</h3><table class=table><tbody><tr><td>No</td></tr><tr><td>Yes, for some applications</td></tr><tr><td>Yes, for at least half of the applications</td></tr><tr><td>Yes, for most or all of the applications</td></tr></tbody></table></div><div id=2 class=tabcontent><h2></h2><h3>Benefit</h3><p>Detection of potential leakage of production secrets</p><h3>Activity</h3><p><p>Have an automated process to add credentials and secrets to configuration files during the deployment process to respective stages. This way, developers and deployers do not see or handle those sensitive values.</p><p>Implement checks that detect the presence of secrets in code repositories and files, and run them periodically. Configure tools to look for known strings and unknown high entropy strings. In systems such as code repositories, where there is a history, include the versions in the checks. Mark potential secrets you discover as sensitive values, and remove them where appropriate. If you cannot remove them from a historic file in a code repository, for example, you may need to refresh the value on the system that consumes the secret. This way, if an attacker discovers the secret, it will not be useful to them.</p><p>Make the system used to store and process the secrets and credentials robust from a security perspective. Encrypt all secrets at rest and in transit. Users who configure this system and the secrets it contains are subject to the principle of least privilege. For example, a developer might need to manage the secrets for a development environment, but not a user acceptance test or production environment.</p></p><h3>Question</h3><p>Do you inject production secrets into configuration files during deployment?</p><h3>Quality criteria</h3><table class=table><tbody><tr><td>Source code files no longer contain active application secrets</td></tr><tr><td>Under normal circumstances, no humans access secrets during deployment procedures</td></tr><tr><td>You log and alert to any abnormal access to secrets</td></tr></tbody></table><h3>Answers</h3><table class=table><tbody><tr><td>No</td></tr><tr><td>Yes, for some applications</td></tr><tr><td>Yes, for at least half of the applications</td></tr><tr><td>Yes, for most or all of the applications</td></tr></tbody></table></div><div id=3 class=tabcontent><h2></h2><h3>Benefit</h3><p>Minimized possibility and timely detection of production secret abuse</p><h3>Activity</h3><p><p>Implement lifecycle management for production secrets, and ensure the generation of new secrets as much as possible, and for every application instance. The use of secrets per application instance ensures that unexpected application behavior can be traced back and properly analyzed. Tools can help in automatically and seemlessly updating the secrets in all relevant places upon change.</p><p>Ensure that all access to secrets (both reading and writing) is logged in a central infrastructure. Review these logs regularly to identify unexpected behavior and perform proper analysis to understand why this happened. Feed issues and root causes into the defect management practice to make sure that the organization will resolve any unacceptable situations.</p></p><h3>Question</h3><p>Do you practice proper lifecycle management for application secrets?</p><h3>Quality criteria</h3><table class=table><tbody><tr><td>You generate and synchronize secrets using a vetted solution</td></tr><tr><td>Secrets are different between different application instances</td></tr><tr><td>Secrets are regularly updated</td></tr></tbody></table><h3>Answers</h3><table class=table><tbody><tr><td>No</td></tr><tr><td>Yes, for some applications</td></tr><tr><td>Yes, for at least half of the applications</td></tr><tr><td>Yes, for most or all of the applications</td></tr></tbody></table></div><div></div></div></div></div></div><footer id=footer><div class=container><div class="col-md-8 col-sm-6"><h4>Sobre nosotros</h4><p>This is an OWASP Project.</br>OWASP is an open community dedicated to enabling organizations to conceive, develop, acquire, operate, and maintain applications that can be trusted. All of the OWASP tools, documents, forums, and chapters are free and open to anyone interested in improving application security.</p><div class=social><a href=https://github.com/OWASP/samm target=_blank style=opacity:1><i class="fab fa-2x fa-github"></i></a><a href=https://owasp.slack.com/messages/C0VF1EJGH target=_blank style=opacity:1><i class="fab fa-2x fa-slack"></i></a><a href=https://www.linkedin.com/company/owasp-samm/ target=_blank style=opacity:1><i class="fab fa-2x fa-linkedin-in"></i></a><a href=https://twitter.com/OwaspSAMM target=_blank style=opacity:1><i class="fab fa-2x fa-twitter"></i></a><a href=https://www.youtube.com/channel/UCEZDbvQrj5APg5cEET49A_g target=_blank style=opacity:1><i class="fa fa-2x fa-youtube"></i></a><a href=mailto:info@owaspsamm.org target=_blank style=opacity:1><i class="fa fa-2x fa-envelope"></i></a></div><hr class="hidden-md hidden-lg hidden-sm"></div><div class="col-md-4 col-sm-6"><a href=https://owasp.org target=_blank><img src=/img/owasp_logo_1c_w_notext.png alt="Secret Management"></a></div></div></footer><div id=copyright><div class=container><div class=col-md-12><p class=pull-left>OWASP SAMM is published under the
<a href=https://creativecommons.org/licenses/by-sa/4.0/>CC BY-SA 4.0 license</a>
and we share the
<a href=https://www2.owasp.org/www-policy/operational/privacy>OWASP Privacy Policy</a></p><p class=pull-right>Plantilla creada por <a href=http://bootstrapious.com/free-templates>Bootstrapious</a>.
Adaptada a Hugo por <a href=https://github.com/devcows/hugo-universal-theme>DevCows</a></p></div></div></div></div><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-127457120-1','auto');ga('send','pageview');}</script><script src=//code.jquery.com/jquery-3.1.1.min.js integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin=anonymous></script><script src=//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js integrity=sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa crossorigin=anonymous></script><script src=//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js></script><script src=//cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/jquery.waypoints.min.js></script><script src=//cdnjs.cloudflare.com/ajax/libs/Counter-Up/1.0/jquery.counterup.min.js></script><script src=//cdnjs.cloudflare.com/ajax/libs/jquery-parallax/1.1.3/jquery-parallax.js></script><script src="//maps.googleapis.com/maps/api/js?v=3.exp"></script><script src=https://owaspsamm.org/js/hpneo.gmaps.js></script><script src=https://owaspsamm.org/js/gmaps.init.js></script><script src=https://owaspsamm.org/js/front.js></script><script src=https://owaspsamm.org/js/tabs.js></script><script src=https://owaspsamm.org/js/owl.carousel.min.js></script><script src=https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js data-cfasync=false></script><script>window.cookieconsent.initialise({"palette":{"popup":{"background":"#66b8b8"},"button":{"background":"#366867"}},"content":{"message":"We use cookies mainly to analyze traffic. Some video providers also use cookies.","href":"https://www2.owasp.org/www-policy/operational/privacy"}});</script></body></html>